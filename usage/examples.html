

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Examples &mdash; PyMGRIT 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Dahlquist" href="../applications/dahlquist.html" />
    <link rel="prev" title="Tutorial" href="tutorial.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> PyMGRIT
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Usage</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simple-solve">Simple solve</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mgrit-parameters">MGRIT Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#output-function">Output function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#define-multigrid-structure">Define multigrid structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spatial-transfer-operator">Spatial transfer operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#space-time-parallelism">Space &amp; time parallelism</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../applications/dahlquist.html">Dahlquist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications/brusselator.html">Brusselator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications/arenstorf_orbit.html">Arenstorf orbit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications/heat_equation.html">Heat Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications/advection.html">Advection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications/firedrake_diffusion_2d.html">Firedrake Diffusion 2D</a></li>
</ul>
<p class="caption"><span class="caption-text">Help</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../help/faq.html">Frequently Asked Questions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyMGRIT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Examples</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/usage/examples.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<p>This page contains short examples that demonstrate basic and advanced usage of PyMGRIT.
The source code for these and more examples is available in the <a class="reference external" href="https://github.com/pymgrit/pymgrit/tree/master/examples">examples</a> folder.</p>
<div class="section" id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#simple-solve">Simple solve</a></p></li>
<li><p><a class="reference internal" href="#mgrit-parameters">MGRIT Parameters</a></p></li>
<li><p><a class="reference internal" href="#output-function">Output function</a></p></li>
<li><p><a class="reference internal" href="#define-multigrid-structure">Define multigrid structure</a></p></li>
<li><p><a class="reference internal" href="#spatial-transfer-operator">Spatial transfer operator</a></p></li>
<li><p><a class="reference internal" href="#space-time-parallelism">Space &amp; time parallelism</a></p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="simple-solve">
<h2>Simple solve<a class="headerlink" href="#simple-solve" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/pymgrit/pymgrit/tree/master/examples/example_dahlquist.py">example_dahlquist.py</a></p>
<p>This example demonstrates basic usage of PyMGRIT for solving Dahlquist’s test problem with a two-level MGRIT solver,
using PyMGRIT’s routines <cite>simple_setup_problem()</cite>, <cite>Mgrit()</cite>, and <cite>mgrit.solve()</cite>. Look at <a class="reference internal" href="quickstart.html"><span class="doc">Quickstart</span></a> for a step-by-step description of this example.</p>
<p>To use <cite>mgrit.solve()</cite>, you need a discrete problem, a multilevel hierarchy for this problem, and an MGRIT solver.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pymgrit.dahlquist.dahlquist</span> <span class="kn">import</span> <span class="n">Dahlquist</span>
<span class="kn">from</span> <span class="nn">pymgrit.core.simple_setup_problem</span> <span class="kn">import</span> <span class="n">simple_setup_problem</span>
<span class="kn">from</span> <span class="nn">pymgrit.core.mgrit</span> <span class="kn">import</span> <span class="n">Mgrit</span>

<span class="c1"># Create Dahlquist&#39;s test problem with 101 time steps in the interval [0, 5]</span>
<span class="n">dahlquist</span> <span class="o">=</span> <span class="n">Dahlquist</span><span class="p">(</span><span class="n">t_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_stop</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">nt</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>

<span class="c1"># Construct a two-level multigrid hierarchy for the test problem using a coarsening factor of 2</span>
<span class="n">dahlquist_multilevel_structure</span> <span class="o">=</span> <span class="n">simple_setup_problem</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="n">dahlquist</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">coarsening</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Set up the MGRIT solver for the test problem and set the solver tolerance to 1e-10</span>
<span class="n">mgrit</span> <span class="o">=</span> <span class="n">Mgrit</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="n">dahlquist_multilevel_structure</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>

<span class="c1"># Solve the test problem</span>
<span class="n">mgrit</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<p>produces the output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INFO</span> <span class="o">-</span> <span class="mi">03</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">20</span> <span class="mi">11</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">03</span> <span class="o">-</span> <span class="n">Start</span> <span class="n">setup</span>
<span class="n">INFO</span> <span class="o">-</span> <span class="mi">03</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">20</span> <span class="mi">11</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">03</span> <span class="o">-</span> <span class="n">Setup</span> <span class="n">took</span> <span class="mf">0.009920358657836914</span> <span class="n">s</span>
<span class="n">INFO</span> <span class="o">-</span> <span class="mi">03</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">20</span> <span class="mi">11</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">03</span> <span class="o">-</span> <span class="n">Start</span> <span class="n">solve</span>
<span class="n">INFO</span> <span class="o">-</span> <span class="mi">03</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">20</span> <span class="mi">11</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">03</span> <span class="o">-</span> <span class="nb">iter</span> <span class="mi">1</span>  <span class="o">|</span> <span class="n">con</span><span class="p">:</span> <span class="mf">7.186185937031941e-05</span>  <span class="o">|</span> <span class="n">con</span><span class="o">-</span><span class="n">fac</span><span class="p">:</span> <span class="o">-</span>                       <span class="o">|</span> <span class="n">runtime</span><span class="p">:</span> <span class="mf">0.01379704475402832</span> <span class="n">s</span>
<span class="n">INFO</span> <span class="o">-</span> <span class="mi">03</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">20</span> <span class="mi">11</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">03</span> <span class="o">-</span> <span class="nb">iter</span> <span class="mi">2</span>  <span class="o">|</span> <span class="n">con</span><span class="p">:</span> <span class="mf">1.2461067076355103e-06</span> <span class="o">|</span> <span class="n">con</span><span class="o">-</span><span class="n">fac</span><span class="p">:</span> <span class="mf">0.017340307063501627</span>    <span class="o">|</span> <span class="n">runtime</span><span class="p">:</span> <span class="mf">0.007235527038574219</span> <span class="n">s</span>
<span class="n">INFO</span> <span class="o">-</span> <span class="mi">03</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">20</span> <span class="mi">11</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">03</span> <span class="o">-</span> <span class="nb">iter</span> <span class="mi">3</span>  <span class="o">|</span> <span class="n">con</span><span class="p">:</span> <span class="mf">2.1015566145245807e-08</span> <span class="o">|</span> <span class="n">con</span><span class="o">-</span><span class="n">fac</span><span class="p">:</span> <span class="mf">0.016864981158092696</span>    <span class="o">|</span> <span class="n">runtime</span><span class="p">:</span> <span class="mf">0.005523681640625</span> <span class="n">s</span>
<span class="n">INFO</span> <span class="o">-</span> <span class="mi">03</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">20</span> <span class="mi">11</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">03</span> <span class="o">-</span> <span class="nb">iter</span> <span class="mi">4</span>  <span class="o">|</span> <span class="n">con</span><span class="p">:</span> <span class="mf">3.144127445017594e-10</span>  <span class="o">|</span> <span class="n">con</span><span class="o">-</span><span class="n">fac</span><span class="p">:</span> <span class="mf">0.014960945726074891</span>    <span class="o">|</span> <span class="n">runtime</span><span class="p">:</span> <span class="mf">0.004599332809448242</span> <span class="n">s</span>
<span class="n">INFO</span> <span class="o">-</span> <span class="mi">03</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">20</span> <span class="mi">11</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">03</span> <span class="o">-</span> <span class="nb">iter</span> <span class="mi">5</span>  <span class="o">|</span> <span class="n">con</span><span class="p">:</span> <span class="mf">3.975214076032893e-12</span>  <span class="o">|</span> <span class="n">con</span><span class="o">-</span><span class="n">fac</span><span class="p">:</span> <span class="mf">0.01264329816633959</span>     <span class="o">|</span> <span class="n">runtime</span><span class="p">:</span> <span class="mf">0.0043201446533203125</span> <span class="n">s</span>
<span class="n">INFO</span> <span class="o">-</span> <span class="mi">03</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">20</span> <span class="mi">11</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">03</span> <span class="o">-</span> <span class="n">Solve</span> <span class="n">took</span> <span class="mf">0.042092084884643555</span> <span class="n">s</span>
<span class="n">INFO</span> <span class="o">-</span> <span class="mi">03</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">20</span> <span class="mi">11</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">03</span> <span class="o">-</span> <span class="n">Run</span> <span class="n">parameter</span> <span class="n">overview</span>
<span class="n">interval</span>                  <span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span>
<span class="n">number</span> <span class="n">points</span>             <span class="p">:</span> <span class="mi">101</span> <span class="n">points</span>
<span class="nb">max</span> <span class="n">dt</span>                    <span class="p">:</span> <span class="mf">0.05000000000000071</span>
<span class="n">level</span>                     <span class="p">:</span> <span class="mi">2</span>
<span class="n">coarsening</span>                <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">cf_iter</span>                   <span class="p">:</span> <span class="mi">1</span>
<span class="n">nested</span> <span class="n">iteration</span>          <span class="p">:</span> <span class="kc">True</span>
<span class="n">cycle</span> <span class="nb">type</span>                <span class="p">:</span> <span class="n">V</span>
<span class="n">stopping</span> <span class="n">tolerance</span>        <span class="p">:</span> <span class="mf">1e-10</span>
<span class="n">communicator</span> <span class="n">size</span> <span class="n">time</span>    <span class="p">:</span> <span class="mi">1</span>
<span class="n">communicator</span> <span class="n">size</span> <span class="n">space</span>   <span class="p">:</span> <span class="o">-</span><span class="mi">99</span>
</pre></div>
</div>
</div>
<div class="section" id="mgrit-parameters">
<h2>MGRIT Parameters<a class="headerlink" href="#mgrit-parameters" title="Permalink to this headline">¶</a></h2>
<p>The MGRIT algorithm in PyMGRIT has a variety of parameters and features. The example ‘example_parameters’ describes these and gives an overview of what is possible with PyMGRIT:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpi4py</span> <span class="kn">import</span> <span class="n">MPI</span>

<span class="kn">from</span> <span class="nn">pymgrit.dahlquist.dahlquist</span> <span class="kn">import</span> <span class="n">Dahlquist</span>
<span class="kn">from</span> <span class="nn">pymgrit.core.simple_setup_problem</span> <span class="kn">import</span> <span class="n">simple_setup_problem</span>
<span class="kn">from</span> <span class="nn">pymgrit.core.mgrit</span> <span class="kn">import</span> <span class="n">Mgrit</span>

<span class="c1"># Creating the finest level problem</span>
<span class="n">dahlquist</span> <span class="o">=</span> <span class="n">Dahlquist</span><span class="p">(</span><span class="n">t_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_stop</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">nt</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>

<span class="c1"># Setup the multilevel structure by using the simple_setup_problem function</span>
<span class="n">dahlquist_multilevel_structure</span> <span class="o">=</span> <span class="n">simple_setup_problem</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="n">dahlquist</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">coarsening</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Setup of the MGRIT algorithm with the multilevel structure</span>
<span class="n">mgrit</span> <span class="o">=</span> <span class="n">Mgrit</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="n">dahlquist_multilevel_structure</span><span class="p">,</span>   <span class="c1"># Problem structure</span>
              <span class="n">transfer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>                            <span class="c1"># Spatial grid transfer. Automatically set if None.</span>
              <span class="n">it</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>                                    <span class="c1"># Maximal number of iterations</span>
              <span class="n">tol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">,</span>                                <span class="c1"># Stopping tolerance</span>
              <span class="n">nested_iteration</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                    <span class="c1"># Nested iterations</span>
              <span class="n">cf_iter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>                                <span class="c1"># Number of CF iterations per relaxation step</span>
              <span class="n">cycle_type</span><span class="o">=</span><span class="s1">&#39;V&#39;</span><span class="p">,</span>                           <span class="c1"># &#39;V&#39; or &#39;F&#39; relaxation</span>
              <span class="n">comm_time</span><span class="o">=</span><span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span><span class="p">,</span>                 <span class="c1"># Time communicator</span>
              <span class="n">comm_space</span> <span class="o">=</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_NULL</span><span class="p">,</span>               <span class="c1"># Space communicator</span>
              <span class="n">logging_lvl</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>                           <span class="c1"># Logging level:</span>
                                                        <span class="c1"># 00 - 10: Debug -&gt; Runtime of all components</span>
                                                        <span class="c1"># 11 - 20: Info  -&gt; Info per iteration + summary</span>
                                                        <span class="c1"># 31 - 50: None  -&gt; No information</span>
              <span class="n">output_fcn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>                          <span class="c1"># Save solutions to file</span>
              <span class="n">output_lvl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>                             <span class="c1"># Output level:</span>
                                                        <span class="c1"># 0 -&gt; output_fcn is never called</span>
                                                        <span class="c1"># 1 -&gt; output_fcn is called when solve stops</span>
                                                        <span class="c1"># 2 -&gt; output_fcn is called after each MGRIT iteration</span>
              <span class="n">random_init_guess</span><span class="o">=</span><span class="kc">False</span>                   <span class="c1"># Random initial guess of all unknowns?</span>
              <span class="p">)</span>

<span class="c1"># Solve</span>
<span class="n">mgrit</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="output-function">
<h2>Output function<a class="headerlink" href="#output-function" title="Permalink to this headline">¶</a></h2>
<p>To store the solutions an output function must be written, which is passed to the MGRIT algorithm. The output function is called in the algorithm after each iteration, at the end or not at all, depending on the setting (see example parameter). The output function is called on each processor. In the example the solution is written to a file via the numpy function save.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pymgrit.dahlquist.dahlquist</span> <span class="kn">import</span> <span class="n">Dahlquist</span>
<span class="kn">from</span> <span class="nn">pymgrit.core.simple_setup_problem</span> <span class="kn">import</span> <span class="n">simple_setup_problem</span>
<span class="kn">from</span> <span class="nn">pymgrit.core.mgrit</span> <span class="kn">import</span> <span class="n">Mgrit</span>

<span class="c1"># Define output function that writes the solution to a file</span>
<span class="k">def</span> <span class="nf">output_fcn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1">#Set path to solution</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;results/&#39;</span> <span class="o">+</span> <span class="s1">&#39;dahlquist&#39;</span>
    <span class="c1"># Create path if not existing</span>
    <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Save solution to file.</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>  <span class="c1"># Add time information for distinguish procs</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_values</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_local</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>   <span class="c1"># Save each time step per processors</span>

<span class="c1"># Creating the finest level problem</span>
<span class="n">dahlquist</span> <span class="o">=</span> <span class="n">Dahlquist</span><span class="p">(</span><span class="n">t_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_stop</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">nt</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>

<span class="c1"># Setup the multilevel structure by using the simple_setup_problem function</span>
<span class="n">dahlquist_multilevel_structure</span> <span class="o">=</span> <span class="n">simple_setup_problem</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="n">dahlquist</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">coarsening</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Setup of the MGRIT algorithm with the multilevel structure</span>
<span class="n">mgrit</span> <span class="o">=</span> <span class="n">Mgrit</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="n">dahlquist_multilevel_structure</span><span class="p">,</span> <span class="n">output_fcn</span><span class="o">=</span><span class="n">output_fcn</span><span class="p">)</span>

<span class="c1"># Solve</span>
<span class="n">info</span> <span class="o">=</span> <span class="n">mgrit</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="c1"># Plot solution if one processor was used</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;results/dahlquist/0.0:5.0.npy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="define-multigrid-structure">
<h2>Define multigrid structure<a class="headerlink" href="#define-multigrid-structure" title="Permalink to this headline">¶</a></h2>
<p>There are several ways to create a multi-level structure that can be solved by the MGRIT algorithm:</p>
<ul class="simple">
<li><p>Using the simple setup function</p></li>
<li><p>Setup each level by t_start, t_end, nt</p></li>
<li><p>Setup by intervals</p></li>
<li><p>Mix</p></li>
</ul>
<p>The following example shows the different possibilities:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pymgrit.dahlquist.dahlquist</span> <span class="kn">import</span> <span class="n">Dahlquist</span>
<span class="kn">from</span> <span class="nn">pymgrit.core.simple_setup_problem</span> <span class="kn">import</span> <span class="n">simple_setup_problem</span>
<span class="kn">from</span> <span class="nn">pymgrit.core.mgrit</span> <span class="kn">import</span> <span class="n">Mgrit</span>

<span class="c1"># Different ways for creating the multilevel structure</span>

<span class="c1"># Variant 1: Simple setup</span>
<span class="n">dahlquist_multilevel_structure_1</span> <span class="o">=</span> <span class="n">simple_setup_problem</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="n">Dahlquist</span><span class="p">(</span><span class="n">t_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_stop</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">nt</span><span class="o">=</span><span class="mi">101</span><span class="p">),</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                                        <span class="n">coarsening</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Mgrit</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="n">dahlquist_multilevel_structure_1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="c1"># Variant 2: Setup each level by t_start, t_end, nt</span>
<span class="n">dahlquist_lvl_0</span> <span class="o">=</span> <span class="n">Dahlquist</span><span class="p">(</span><span class="n">t_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_stop</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">nt</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>
<span class="n">dahlquist_lvl_1</span> <span class="o">=</span> <span class="n">Dahlquist</span><span class="p">(</span><span class="n">t_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_stop</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">nt</span><span class="o">=</span><span class="mi">51</span><span class="p">)</span>
<span class="n">dahlquist_lvl_2</span> <span class="o">=</span> <span class="n">Dahlquist</span><span class="p">(</span><span class="n">t_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_stop</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">nt</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="n">dahlquist_multilevel_structure_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">dahlquist_lvl_0</span><span class="p">,</span> <span class="n">dahlquist_lvl_1</span><span class="p">,</span> <span class="n">dahlquist_lvl_2</span><span class="p">]</span>
<span class="n">Mgrit</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="n">dahlquist_multilevel_structure_2</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="c1"># Variant 3: Setup by intervals</span>
<span class="n">t_interval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">dahlquist_lvl_0</span> <span class="o">=</span> <span class="n">Dahlquist</span><span class="p">(</span><span class="n">t_interval</span><span class="o">=</span><span class="n">t_interval</span><span class="p">)</span>
<span class="n">dahlquist_lvl_1</span> <span class="o">=</span> <span class="n">Dahlquist</span><span class="p">(</span><span class="n">t_interval</span><span class="o">=</span><span class="n">t_interval</span><span class="p">[::</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># Takes every second point from t_interval</span>
<span class="n">dahlquist_lvl_2</span> <span class="o">=</span> <span class="n">Dahlquist</span><span class="p">(</span><span class="n">t_interval</span><span class="o">=</span><span class="n">t_interval</span><span class="p">[::</span><span class="mi">4</span><span class="p">])</span>  <span class="c1"># Takes every fourth point from t_interval</span>
<span class="n">dahlquist_multilevel_structure_3</span> <span class="o">=</span> <span class="p">[</span><span class="n">dahlquist_lvl_0</span><span class="p">,</span> <span class="n">dahlquist_lvl_1</span><span class="p">,</span> <span class="n">dahlquist_lvl_2</span><span class="p">]</span>
<span class="n">Mgrit</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="n">dahlquist_multilevel_structure_3</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="c1"># Variant 4: Mix</span>
<span class="n">dahlquist_lvl_0</span> <span class="o">=</span> <span class="n">Dahlquist</span><span class="p">(</span><span class="n">t_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_stop</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">nt</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>
<span class="n">dahlquist_lvl_1</span> <span class="o">=</span> <span class="n">Dahlquist</span><span class="p">(</span><span class="n">t_interval</span><span class="o">=</span><span class="n">dahlquist_lvl_0</span><span class="o">.</span><span class="n">t</span><span class="p">[::</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># Using t from the upper level.</span>
<span class="n">dahlquist_lvl_2</span> <span class="o">=</span> <span class="n">Dahlquist</span><span class="p">(</span><span class="n">t_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_stop</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">nt</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="n">dahlquist_multilevel_structure_4</span> <span class="o">=</span> <span class="p">[</span><span class="n">dahlquist_lvl_0</span><span class="p">,</span> <span class="n">dahlquist_lvl_1</span><span class="p">,</span> <span class="n">dahlquist_lvl_2</span><span class="p">]</span>
<span class="n">Mgrit</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="n">dahlquist_multilevel_structure_4</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="spatial-transfer-operator">
<h2>Spatial transfer operator<a class="headerlink" href="#spatial-transfer-operator" title="Permalink to this headline">¶</a></h2>
<p>TODO</p>
</div>
<div class="section" id="space-time-parallelism">
<h2>Space &amp; time parallelism<a class="headerlink" href="#space-time-parallelism" title="Permalink to this headline">¶</a></h2>
<p>TODO</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../applications/dahlquist.html" class="btn btn-neutral float-right" title="Dahlquist" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tutorial.html" class="btn btn-neutral float-left" title="Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Jens Hahne

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>